<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:o="http://omnifaces.org/ui"
    template="/WEB-INF/template.xhtml">
	<ui:define name="content">
	
	
		<p:fieldset legend="Cadastro de veiculos" style="margin-top: 10px">
			
			<h:form id="frm">
				<div class="ContainerIndent ui-fluid">
					<p:panel>
						<div class="ContainerIndent">
							<p:messages id="msg" autoUpdate="true" closable="true"/>
						</div>
						<div class="Container">
							<div class="Container10 Responsive50">
								<div class="ContainerIndent">
									<div class="Container100">
										<p:outputLabel for="placa" value="Placa"/>
										<p:inputText id="placa" title="Placa" required="true" requiredMessage="Placa é obrigatório." value="#{veiculoManMB.veiculo.placa}" styleClass="FontBold Fs15 hardblue"/>
									</div>
								</div>
							</div>
							<div class="Container25 Responsive50">
								<div class="ContainerIndent">
									<div class="Container100">
										<p:outputLabel for="modelo" value="Modelo"/>
										<p:inputText  id="modelo" title="Modelo" value="#{veiculoManMB.veiculo.modelo}" required="true" requiredMessage="Modelo é obrigatório." styleClass="FontBold Fs15 hardblue"/>
									</div>
								</div>
							</div>
							<div class="Container25 Responsive50">
								<div class="ContainerIndent">
									<div class="Container100">
										<p:outputLabel for="nome" value="Marca"/>
										<p:inputText  id="nome" title="Marca" value="#{veiculoManMB.veiculo.marca}" styleClass="FontBold Fs15 hardblue"/>
									</div>
								</div>
							</div>
							<div class="Container40 Responsive50">
								<div class="ContainerIndent">
									<div class="Container100">
										<p:outputLabel for="cliente" value="Proprietário"/>
										<p:selectOneMenu id="cliente" value="#{veiculoManMB.veiculo.pessoa}" styleClass="FontBold Fs15 hardblue" required="true" requiredMessage="Proprietário é obrigatório.">
											<f:selectItem itemLabel="Selecione um proprietário" />
											<f:selectItems value="#{veiculoManMB.pessoas}" var="pessoa" itemValue="#{pessoa}" itemLabel="#{pessoa.nome}"  />
										</p:selectOneMenu>
									</div>
								</div>
							</div>
						</div>
						
						<div class="EmptyBox20"></div>
						<div class="Container">
						
							<div class="Container20 Responsive50">
								<div class="ContainerIndent">
									<div class="Container100">
										<p:commandButton title="Registrar" value="Registrar" id="botaoSalvar" update="frm,frm:placa" action="#{veiculoManMB.grava}" />
									</div>
								</div>
							</div>
							
							<div class="Container20 Responsive50">
								<div class="ContainerIndent">
									<div class="Container100">
										<p:commandButton value="Adicinar avarias" oncomplete="PF('addavaria').show()" process="@this" update="frm,frmavaria"/>
									</div>
								</div>
							</div>
							
						</div>
						
					</p:panel>
				</div>
			</h:form>
			
			
			
			<h:form id="frmavaria">
			
				<p:dialog header="Cadastro de avaria" id="addavaria" widgetVar="addavaria" width="500" height="150" modal="true">
					<div class="Container">
						<div class="Container100 Responsive50">
							<div class="ContainerIndent">
								<div class="Container100">
									<p:outputLabel for="descricao" value="Descrição"/>
									<p:inputText  id="descricao" title="Descrição" style="width: 100%" value="#{veiculoManMB.avaria.descricao}" styleClass="FontBold Fs18 hardblue" required="true" requiredMessage="Descrição é obrigatório."/>
								</div>
							</div>
						</div>
					</div>
					<div class="EmptyBox20"></div>
					<div class="Container">
						<div class="Container50 Responsive50">
							<div class="ContainerIndent">
								<div class="Container100">
									<p:commandButton title="Registrar" value="Registrar" update="frmavaria,avaria" action="#{veiculoManMB.adicionaAvaria}" />
								</div>
							</div>
						</div>
					</div>
				</p:dialog>
				<p:dataTable id="avaria" var="avaria" value="#{veiculoManMB.avarias}"  rendered="#{veiculoManMB.avarias.size() > 0}"
	                                     rows="5" paginator="true" paginatorTemplate="{CurrentPageReport}  
	                                     {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
	                                     rowsPerPageTemplate="5,10,15" paginatorPosition="bottom"  emptyMessage="Nenhuma avaria encontrada" 
	                                     paginatorAlwaysVisible="true" reflow="true">
					<p:column headerText="Avaria" sortBy="#{avaria.descricao}">
						<h:outputText value="#{avaria.descricao}" />
					</p:column>
					<p:column style="width: 50px">
						<p:commandButton title="Excluir" oncomplete="PF('remover').show()" process="@this" update="frmavaria" icon="ui-icon-trash">
							<f:setPropertyActionListener   value="#{avaria}" target="#{veiculoManMB.avaria}"/>
						</p:commandButton>
					</p:column>
				</p:dataTable>
				<p:dialog header="Deseja excluir a avaria" id="remover" widgetVar="remover" width="350" height="100">
					<div class="col-70">
						<p:outputLabel id="idNome" value="#{veiculoManMB.avaria.descricao}"/>
						<hr/>
					</div>
					<p:button value="Não" onclick="PF('remover').hide(); return false;" />
					<p:commandButton value="Sim" action="#{veiculoManMB.removeAvaria}" update="frm,avaria,frmavaria"  onclick="PF('remover').hide()"/>
				</p:dialog>
			</h:form>
			
			
		</p:fieldset>
	</ui:define>
</ui:composition>